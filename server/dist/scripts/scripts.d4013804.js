"use strict";angular.module("clientApp",["angular-web-notification","angular-growl","cfp.hotkeys","ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","ui.bootstrap","wysiwyg.module"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl",controllerAs:"login"}).when("/signup",{templateUrl:"views/signup.html",controller:"SignupCtrl",controllerAs:"signup"}).when("/settings",{templateUrl:"views/settings.html",controller:"SettingsCtrl",controllerAs:"settings"}).when("/help",{templateUrl:"views/help.html",controller:"HelpCtrl",controllerAs:"help"}).when("/admin",{templateUrl:"views/admin.html",controller:"AdminCtrl",controllerAs:"admin"}).otherwise({redirectTo:"/"})}]).config(["growlProvider",function(a){a.globalReversedOrder(!0),a.globalTimeToLive(3e3),a.globalDisableCountDown(!0),a.globalPosition("bottom-right")}]),angular.module("clientApp").controller("MainCtrl",["$rootScope","$scope","$cookieStore","$http","$location","$uibModal","$sce","authenticate","socket","notifications","deskLogs","hotkeys",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a,b){return a=new Date(a),b=new Date(b),a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate()}var n={log:{_id:"",type:"",itemno:"",slug:"",timeIn:"",timeOut:"",rt:"",source:"",feed:"",format:"",wr:"",updatedBy:"",createdBy:""}};b.log=function(a){console.info("From template:",a)},b.updateLocalApplicationData=function(){k.updateLocalApplicationData(b.currentDate).then(function(a){b.desks=a.desks,b.lists=a.lists,b.logs=a.logs,b.count=a.count,b.users=a.users,b.defaultList=k.getDefaultList(b.lists[b.currentDesk])})["catch"](function(a){console.error(a)})},b.selectedLog=angular.copy(n.log),b.currentDesk="incoming",b.datepicker={},b.datepicker.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],b.datepicker.format=b.datepicker.formats[0],b.datepicker.altInputFormats=["M!/d!/yyyy"],b.datepicker.opened=!1,b.datepicker.open=function(){b.datepicker.opened=!0},b.datepicker.options={formatYear:"yy",maxDate:null,minDate:new Date(2016,1,1),startingDay:1},b.trustHTML=function(a){return g.trustAsHtml(a)},b.today=function(){b.currentDate=new Date},b.clear=function(){b.currentDate=null},b.today(),b.updateLocalApplicationData(),h.requireLogin().then(function(b){a.user=b,a.$emit("loggedIn",b)})["catch"](function(a){console.error(a),e.path("/login")}),b.hasPermission=function(a){return b.user?h.hasPermission(b.user,a):!1},b.selectTab=function(a,c){c.preventDefault(),b.selectedLog=angular.copy(n.log),b.currentDesk=a,b.defaultList=k.getDefaultList(b.lists[b.currentDesk])},b.createListEntry=function(){b.listModal=f.open({animation:!0,templateUrl:"../../views/templates/modalListEntry.html",controller:"ModalCtrl",size:"sm",resolve:{data:function(){var a={desks:b.desks,form:{desk:b.currentDesk},title:"Create New List"};return a},submit:function(){return function(c){c.createdAt=b.currentDate;var d={list:c,sso:a.user.sso,currentWorkingDate:b.currentDate};k.createList(d).then(function(){j.createPopup({type:"success",config:{title:"List Added"},text:"Your list was successfully added!"})})["catch"](function(a){console.error(a),j.createPopup({type:"error",config:{title:"List Not Added",ttl:-1},text:a})})}}}})},b.editListEntry=function(c){return c.locked===!0?(j.createPopup({type:"warning",config:{title:"Editing in Progress"},text:"This list is currently open for editing in another browser. Please wait for the spinning icon to disappear before trying again."}),!1):(i.lockListEntry(c),b.listModal=f.open({animation:!0,templateUrl:"../../views/templates/modalListEntry.html",controller:"ModalCtrl",size:"sm",resolve:{data:function(){var a={desks:b.desks,form:c,title:"Edit List"};return a},submit:function(){return function(d){var e={list:d,sso:a.user.sso,currentWorkingDate:b.currentDate};i.unlockListEntry(c),k.updateList(e).then(function(){j.createPopup({type:"success",config:{title:"List Modified"},text:"Your list was successfully changed!"})})["catch"](function(a){console.error(a),j.createPopup({type:"error",config:{title:"List Not Modified",ttl:-1},text:a})})}}}}),void b.listModal.result.then(function(){},function(){i.unlockListEntry(c)}))},b.deleteListEntry=function(b){return confirm("Are you sure you want to delete this list? Any logs currently under this list will be lost.")?void k.deleteList({id:b,sso:a.user.sso}).then(function(a){j.createPopup({type:"success",config:{title:"List Deleted"},text:"Your list was deleted successfully!"})})["catch"](function(a){console.error(a),j.createPopup({type:"error",config:{title:"List Not Deleted",ttl:-1},text:a})}):!1},b.createLogEntry=function(){b.selectedLog=angular.copy(n.log),b.logModal=f.open({animation:!0,templateUrl:"../../views/templates/modalLogEntry.html",controller:"ModalCtrl",size:"lg",resolve:{data:function(){var a={title:"Create New Story",currentDesk:b.currentDesk,lists:b.lists,users:b.users,form:{selectedList:b.defaultList._id,activeDate:b.currentDate}};return a},submit:function(){return function(c){var d={};d.selectedList=c.selectedList,d.currentWorkingDate=b.currentDate,d.sso=a.user.sso,d.log=c,d.log.updatedBy=a.user.sso,d.log.createdBy=a.user.sso,d.log.createdAt=b.currentDate,k.createLog(d).then(function(){j.createPopup({type:"success",config:{title:"Story Added"},text:"Your log was successfully added!"})})["catch"](function(a){console.error(a),j.createPopup({type:"err",config:{title:"Story Not Added",ttl:-1},text:a})})}}}})},b.editLogEntry=function(){return b.logs[b.selectedLog._id].locked===!0?(j.createPopup({type:"warning",config:{title:"Editing in Progress"},text:"This story is currently open for editing in another browser. Please wait for the spinning icon to disappear before trying again."}),!1):(i.lockLogEntry(b.selectedLog),b.logModal=f.open({animation:!0,templateUrl:"../../views/templates/modalLogEntry.html",controller:"ModalCtrl",size:"lg",resolve:{data:function(){var a={title:"Edit Story",currentDesk:b.currentDesk,lists:b.lists,users:b.users,form:b.selectedLog};return a.form.activeDate=new Date(b.selectedLog.activeDate),a},submit:function(){return function(c){var d={};d.selectedList=c.selectedList,d.currentWorkingDate=b.currentDate,d.sso=a.user.sso,d.log=angular.copy(c),d.log.updatedBy=a.user.sso,delete d.log.selectedList,k.updateLog(d).then(function(){i.unlockLogEntry(b.selectedLog),j.createPopup({type:"success",config:{title:"Story Modified"},text:"Your story was successfully modified!"})})["catch"](function(a){console.error(a),j.createPopup({type:"error",config:{title:"Story Not Mofified",ttl:-1},text:a})})}}}}),void b.logModal.result.then(function(){},function(){i.unlockLogEntry(b.selectedLog)}))},b.deleteLogEntry=function(){if(!confirm("Are you sure you want to delete this story? "))return!1;var c={_id:b.selectedLog._id,sso:a.user.sso,date:b.currentDate};k.deleteLog(c).then(function(a){b.selectedLog=angular.copy(n.log),j.createPopup({type:"success",config:{title:"Story Deleted"},text:"Your story was deleted, but can be restored in the Admin Panel."})})["catch"](function(a){console.error(a),j.createPopup({type:"error",config:{title:"Story Not Deleted",ttl:-1},text:a})})},b.selectLog=function(a,c){b.selectedLog=angular.copy(b.logs[a]),b.selectedLog.selectedList=c},l.add({combo:"shift+s",description:"Create a new story.",callback:function(){b.createLogEntry()}}),l.add({combo:"shift+l",description:"Create a new list.",callback:function(){b.createListEntry()}}),l.add({combo:"shift+z",description:"Delete selected story.",callback:function(){b.deleteLogEntry()}}),l.add({combo:"shift+e",description:"Edit selected story.",callback:function(){b.editLogEntry()}}),i.on("updateApplication",function(a){m(b.currentDate,a.date)&&(b.logs=k.organizeLogs(a.logs,"_id"),b.lists=k.organizeLists(a.lists),b.count=k.getLogCount(b.lists,b.logs),b.$apply())}),i.on("updateAppLogs",function(a){m(b.currentDate,a.date)&&(b.logs=k.organizeLogs(a.logs,"_id"),b.$apply())}),i.on("updateAppLists",function(a){b.lists=k.organizeLists(a.lists),b.count=k.getLogCount(b.lists,b.logs),b.$apply()}),i.on("lockLogEntry",function(a){b.logs[a._id]&&(b.logs[a._id].locked=!0,b.$apply())}),i.on("unlockLogEntry",function(a){b.logs[a._id]&&(b.logs[a._id].locked=!1,b.$apply())}),i.on("lockListEntry",function(a){var c=k.getListIndexFromSingleList(b.lists,a);b.lists[a.desk][c].locked=!0,b.$apply()}),i.on("unlockListEntry",function(a){var c=k.getListIndexFromSingleList(b.lists,a);b.lists[a.desk][c].locked=!1,b.$apply()})}]),angular.module("clientApp").controller("LoginCtrl",["$q","$cookieStore","authenticate","$scope","$http","$location","notifications","socket",function(a,b,c,d,e,f,g,h){c.logOut(),d.submit=function(){c.createJSONWebToken(d.login).then(function(a){a.status?(b.put("jwt",{sso:d.login.sso,token:a.data}),f.path("/")):(g.createPopup({type:"error",config:{title:"Login Error"},text:a.data}),d.login.pw="")})["catch"](function(a){console.error(a),d.login="",g.createPopup({type:"error",config:{title:"Internal Error"},text:"There was an error processing your login."})})}}]),angular.module("clientApp").controller("SignupCtrl",["$location","$scope","$http","$cookieStore","authenticate","notifications",function(a,b,c,d,e,f){var g,h;b.signup=h={},h.user=g={},h.error={},h.submit=function(){h.error={message:"",sso:!1,pw1:!1,pw2:!1};var b=/^\d+$/.test(g.sso);return b&&9===g.sso.length?g.pw1!==g.pw2?(f.createErrorPopUp({text:"Your passwords do not match!",title:"Validation Error"}),h.error.pw1=h.error.pw2=!0,!1):void e.signUp(g).then(function(b){d.put("jwt",{sso:g.sso,token:b.data}),a.path("/")})["catch"](function(a){console.error(a),f.createErrorPopUp({text:a||"Internal Error 500",title:"Verification Error"})}):(h.error.sso=!0,f.createErrorPopUp({text:"Please enter a valid SSO!",title:"Validation Error"}),!1)}}]),angular.module("clientApp").controller("NavigationCtrl",["$rootScope","$scope","$http","$timeout","$uibModal","$cookieStore","authenticate","notifications","socket",function(a,b,c,d,e,f,g,h,i){b.sound=!1,b.onlineUsers=[],b.toggleSound=function(c){c.preventDefault(),b.sound=!b.sound,a.hasOwnProperty("user")?a.user.preferences.sound=b.sound:a.user={preferences:{sound:b.sound}},h.createPopup({type:"info",config:{title:"Sound settings changed!"},text:"Your sound settings were successfully changed."})},b.hasPermission=function(a){return b.user?g.hasPermission(b.user,a):!1},b.animate=!1,a.$on("updateNotifications",function(a,c){d(function(){b.notifications=c,b.notificationCount=c.length,b.animate=!0,setTimeout(function(){b.animate=!1},3e3)})}),b.launchFeedback=function(d){d.preventDefault(),b.logModal=e.open({animation:!0,templateUrl:"../../views/templates/modalFeedbackEntry.html",controller:"ModalCtrl",size:"lg",resolve:{data:function(){var a={form:{}};return a},submit:function(){return function(b){b.user=a.user.sso;var d=c.post("/feedback",b);d.success(function(a){a.status?h.createPopup({type:"success",config:{title:"Feedback Sent"},text:"Your feedback has been recorded and an email has been sent. You should receive a copy of this email shortly!"}):(console.error(a.data),h.createPopup({type:"error",config:{title:"Feedback Not Sent",ttl:-1},text:"There was an error sending your feedback. If you are receiving this message, something has gone wrong in the server. Please contact support."}))}),d.error(function(a){console.error(a),h.createPopup({type:"error",config:{title:"Feedback Not Sent",ttl:-1},text:"There was an error sending your feedback. If you are receiving this message, something has gone wrong in the server. Please contact support."})})}}}})},a.$on("loggedIn",function(a,c){b.loggedIn=!0,b.username=c.first+" "+c.last,i.emit("setUserOnline",c.sso),i.emit("setJWT",f.get("jwt")),b.user=c}),a.$on("loggedOut",function(a,c){b.loggedIn=!1,b.username="Logged Out..."}),i.on("notification",function(a){h.createNotification(a)}),i.on("popup",function(a){h.createPopup(a)}),i.on("updateOnlineUsers",function(a){b.onlineUsers=a}),i.on("pollUsers",function(){})}]),angular.module("clientApp").controller("ModalCtrl",["$scope","$uibModalInstance","socket","data","submit","hotkeys",function(a,b,c,d,e,f){a.datepicker={},a.datepicker.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],a.datepicker.format=a.datepicker.formats[0],a.datepicker.altInputFormats=["M!/d!/yyyy"],a.datepicker.opened=!1,a.datepicker.open=function(){a.datepicker.opened=!0},a.datepicker.options={formatYear:"yy",maxDate:null,minDate:new Date(2016,1,1),startingDay:1},a.today=function(){a.form.activeDate=new Date},a.clear=function(){a.form.activeDate=null},a.panelTitle=d.title,a.panelLocked=!1,a.tooltips={lock:"Click the lock to keep this panel open after saving."},a.wysiwyg={buttons:[["bold","italic","underline","strikethrough"],["left-justify","center-justify","right-justify"],["ordered-list","unordered-list"],["font-color"]]},angular.forEach(d,function(a,b){this[b]=a},a),a.togglePanelLock=function(){a.panelLocked=!a.panelLocked},a.submit=function(){e(a.form),a.panelLocked||b.close(null)},a.close=function(){b.dismiss("cancel")},f.add({combo:"shift+l",description:"Toggle Panel Lock",callback:function(){a.togglePanelLock()}})}]),angular.module("clientApp").controller("SettingsCtrl",["$rootScope","$scope","$cookieStore","$http","$location","$uibModal","$sce","authenticate","socket","notifications","deskLogs","history",function(a,b,c,d,e,f,g,h,i,j,k,l){b.user={},b.user.img=b.user.img||"http://placehold.it/300x300&text=Coming Soon",b.form={},b.statistics={};var m={icons:{idle:'<i class="fa fa-check-circle-o" aria-hidden="true"></i>',working:'<i class="fa fa-cog fa-spin fa-fw"></i>',error:'<i class="fa fa-exclamation-triangle" aria-hidden="true"></i>'},status:{error:{flag:!1,pw1:!1,pw2:!1}}};b.status={message:"Idle "+m.icons.idle,error:m.status.error},h.requireLogin().then(function(d){b.user=d,console.info(b.user),a.$emit("loggedIn",d),i.emit("setUserData",d),i.emit("setJWT",c.get("jwt")),l.getHistory(b.user.sso).then(function(a){b.statistics.history=a})["catch"](function(a){console.error(a)})})["catch"](function(a){console.error(a),e.path("/login")}),k.getDesks().then(function(a){if(!a.status)throw new Error("Could not get desk information.");b.desks=a.data})["catch"](function(a){console.error(a)}),b.saveAccount=function(){if(b.form.pw1!==b.form.pw2)return b.status={message:"Your passwords do not match! "+m.icons.error,error:{flag:!0,pw1:!0,pw2:!0}},!1;if(b.form.pw1.length<8)return b.status={message:"Your passwords must be at least 8 characters long! "+m.icons.error,error:{flag:!0,pw1:!0,pw2:!0}},!1;b.status.error=m.status.error,b.status.message="Saving user data "+m.icons.working,b.user.password=b.form.pw1;var a=d.post("/users",b.user);a.success(function(a){b.status.message="Data has been saved! "+m.icons.idle}),a.error(function(a){b.status.error.flag=!0,b.status.message="An error occurred saving youd data! "+m.icons.error,console.error(a)})},b.updatePreferences=function(){var a=d.post("/users/preferences",b.user);b.status.error=m.status.error,b.status.message="Saving user data "+m.icons.working,a.success(function(a){console.log(a),b.status.message="Preferences have been updated! "+m.icons.idle}),a.error(function(a){b.status.error.flag=!0,b.status.message="An error occurred saving your data! "+m.icons.error})},b.trustHTML=function(a){return g.trustAsHtml(a)}}]),angular.module("clientApp").controller("HelpCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("clientApp").controller("AdminCtrl",["$rootScope","$scope","$cookieStore","$http","$location","$uibModal","authenticate","socket","notifications","deskLogs","hotkeys",function(a,b,c,d,e,f,g,h,i,j){b.loading=!1,b.menuClosed=!1,b.currentPage="dashboard",g.requireLogin().then(function(d){a.user=d,a.$emit("loggedIn",d),h.emit("setUserData",{userData:d,currentDate:b.currentDate}),h.emit("setJWT",c.get("jwt"))})["catch"](function(a){console.error(a),e.path("/login")}),b.changePage=function(a,c){c=c||null,c&&c.preventDefault(),b.currentPage=a},b.toggleMenu=function(){b.menuClosed=!b.menuClosed}}]),angular.module("clientApp").controller("AdminstoriesCtrl",["$rootScope","$scope","$q","$uibModal","deskLogs","notifications",function(a,b,c,d,e,f){function g(){e.getPermanentLists().then(function(a){b.lists=e.organizeLists(a.data),console.info(b.lists)})["catch"](function(a){b.lists={},console.err(a),f.createPopup({type:"err",config:{title:"Error",ttl:-1},text:a})})}function h(){b.stories=[],b.loading=!0,e.getOrphanedLogs().then(function(a){b.stories=a.data,b.loading=!1})["catch"](function(a){b.loading=!1,console.error(a),f.createErrorPopUp({text:a,title:"Error getting orphaned logs."})})}function i(){console.info("getRepeatingStories()"),b.loading=!0,b.stories=[],e.getRepeatingStories().then(function(a){b.stories=a.data,b.loading=!1})["catch"](function(a){console.error(a),b.loading=!1,f.createPopup({type:"err",config:{title:"Error",ttl:-1},text:a})})}function j(){e.get("users",{}).then(function(a){b.users=a.data})["catch"](function(a){console.error(a),f.createErrorPopUp({text:a,title:"Error getting user list."})})}b.stories=[],g(),h(),j(),b.getOrphanedStories=function(){return h()},b.getRepeatingStories=function(){return i()},b.searchStories=function(a){a.preventDefault()},b.deleteAllStories=function(){if(!confirm("Are you sure you want to permanently delete all stories from the bin? "))return!1;b.loading=!0;var a=c.defer();c.all(b.stories.map(function(b){e.trashLog(b._id).then(function(b){a.resolve(b)})["catch"](function(b){a.reject(b)})})).then(function(){b.getOrphanedStories(),f.createPopup({type:"success",config:{title:"Success"},text:"All stories were permanently removed."})})["catch"](function(a){b.loading=!1,f.createPopup({type:"err",config:{title:"Error",ttl:-1},text:a})})},b.deleteStory=function(c,d){return confirm("Are you sure you want to permanently delete this story? ")?void e.trashLog([d,a.user.sso]).then(function(a){console.info(a),b.stories.splice(c,1),f.createPopup({type:"success",config:{title:"Success"},text:"The story was permanently removed from the database."})})["catch"](function(a){console.error(a),f.createPopup({type:"err",config:{title:"Error",ttl:-1},text:a})}):!1},b.restoreStory=function(a,c){return confirm("Are you sure you want to restore this story? ")?void e.restoreLog({_id:c}).then(function(c){b.stories.splice(a,1),f.createPopup({type:"success",config:{title:"Success"},text:"The story was returned to the DeskLog."})})["catch"](function(a){console.error(a),f.createPopup({type:"err",config:{title:"Error",ttl:-1},text:a})}):!1},b.createRepeatingStory=function(){b.logModal=d.open({animation:!0,templateUrl:"../../views/templates/modalRepeatingLogEntry.html",controller:"ModalCtrl",size:"lg",resolve:{data:function(){var a={title:"Create New Repeating Story",users:b.users,lists:b.lists,form:{}};return a},submit:function(){return function(c){c.createdBy=a.user.sso,c.updatedBy=a.user.sso,e.createRepeatingLog(c).then(function(a){c.createdAt=new Date,b.stories.unshift(c),f.createPopup({type:"success",config:{title:"Story Added"},text:"Your log was successfully added!"})})["catch"](function(a){console.error(a),f.createPopup({type:"err",config:{title:"Story Not Added",ttl:-1},text:a})})}}}})},b.deleteRepeatingStory=function(a,c){return confirm("Are you sure you want to permanently delete this repeating story? ")?void e.trashRepeatingLog([c]).then(function(c){console.info(c),b.stories.splice(a,1)})["catch"](function(a){console.error(a),f.createPopup({type:"error",config:{title:"Story Not Added",ttl:-1},text:a})}):!1},b.editRepeatingStory=function(c,g){b.logModal=d.open({animation:!0,templateUrl:"../../views/templates/modalRepeatingLogEntry.html",controller:"ModalCtrl",size:"lg",resolve:{data:function(){var a={title:"Edit Repeating Story",users:b.users,lists:b.lists,form:g};return a},submit:function(){return function(d){d.updatedBy=a.user.sso,console.info("logEntry",d),e.updateRepeatingLog(d).then(function(a){console.info(a),b.stories[c]=a.data})["catch"](function(a){console.error(a),f.createPopup({type:"err",config:{title:"Story Not Added",ttl:-1},text:a})})}}}})}}]),angular.module("clientApp").controller("AdminmonitorCtrl",["$scope","monitor",function(a,b){a.status={},setInterval(function(){b.getCurrentStatus().then(function(b){a.status=b.data})["catch"](function(a){console.error(a)})},5e3)}]),angular.module("clientApp").controller("AdminnotificationsCtrl",["$scope","notifications",function(a,b){console.info("AdminnotificationsCtrl called..."),a.notification={type:"info",config:{title:"",ttl:"-1"},text:""},a.submit=function(){var c=angular.copy(a.notification);c.config.ttl=parseInt(a.notification.config.ttl),b.sendGlobalNotification(c).then(function(){console.info("Notification sent.")})["catch"](function(a){console.error(a),b.createPopup({type:"error",config:{title:"Notification Error"},text:a})})},console.info(a.notification)}]),angular.module("clientApp").controller("AdmindashboardCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("clientApp").controller("AdminusersCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("clientApp").controller("AdminlistsCtrl",["$scope","socket","deskLogs","notifications",function(a,b,c,d){function e(){c.getDesks().then(function(b){return a.desks=b.data,c.getLists([a.currentDate])}).then(function(b){a.lists=c.organizeLists(b.data,"desk")})["catch"](function(a){console.error(a),d.createPopup({type:"error",config:{title:"Internal Error",ttl:-1},text:a})})}a.currentDate=new Date,e()}]),angular.module("clientApp").controller("AdminreportsCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("clientApp").directive("dndDragLog",["$parse","$timeout","deskLogs","socket","notifications",function(a,b,c,d,e){return function(a,f,g){function h(a,b){var c=a.indexOf(b);return-1!=c&&a.splice(a.indexOf(b),1),a}function i(a,b,c){return a.splice(a.indexOf(c)+1,0,b),a}f.attr("draggable","true"),f.on("dragstart",function(c){c=c.originalEvent||c,c.stopPropagation();var h=a.$eval(g.dndDragLocked);if(h===!0)return e.currentlyEditing(),!0;var i={logId:a.$eval(g.dndDragLog),list:a.$eval(g.dndDragCurrentList)};return d.lockLogEntry({_id:i.logId}),"false"==f.attr("draggable")?!0:(f.addClass("dragging"),b(function(){f.addClass("draggingSource")},0),i=angular.toJson(i),void c.dataTransfer.setData("Text",i))}),f.on("dragend",function(c){c=c.originalEvent||c,c.stopPropagation();var e=a.$eval(g.dndDragLog);d.unlockLogEntry({_id:e}),f.removeClass("dragging"),b(function(){f.removeClass("draggingSource")},0)}),f.on("dragenter",function(a){a=a.originalEvent||a,a.preventDefault(),f.addClass("dragover")}),f.on("dragover",function(a){a=a.originalEvent||a,a.preventDefault()}),f.on("dragleave",function(a){a=a.originalEvent||a,a.preventDefault(),f.removeClass("dragover")}),f.on("drop",function(b){b=b.originalEvent||b,b.preventDefault(),f.removeClass("dragover");var d=b.dataTransfer.getData("Text")||b.dataTransfer.getData("text/plain");try{var e=JSON.parse(d),j=a.$eval(g.dndDragCurrentList),k=a.$eval(g.dndDragLog)}catch(l){return console.error("no dataTransfer, or could not parse dataTransfer"),!0}e.list.logs=h(e.list.logs,e.logId),j.logs=h(j.logs,e.logId),j.logs=i(j.logs,e.logId,k);var m=e.list._id==j._id?[j]:[e.list,j];c.updateLogOrder(JSON.stringify(m))})}}]),angular.module("clientApp").directive("dndDropDesk",["$rootScope","$parse","$timeout","deskLogs",function(a,b,c,d){return function(b,c,e){c.on("dragenter",function(a){a=a.originalEvent||a,a.preventDefault()}),c.on("dragover",function(a){a=a.originalEvent||a,a.preventDefault()}),c.on("dragleave",function(a){a=a.originalEvent||a,console.info("dragleave"),a.preventDefault()}),c.on("drop",function(c){c=c.originalEvent||c,c.preventDefault();var f,g=c.dataTransfer.getData("Text")||c.dataTransfer.getData("text/plain");try{f=JSON.parse(g)}catch(h){return console.error("no dataTransfer, or could not parse dataTransfer"),!0}if(!f.logId)return!0;var i=b.$eval(e.dndDropDesk);d.dropLogOnDesk({log:f,desk:i,sso:a.user.sso})})}}]),angular.module("clientApp").directive("dndDropList",["$rootScope","$parse","$timeout","deskLogs",function(a,b,c,d){return function(b,c,e){c.on("dragenter",function(a){a=a.originalEvent||a,a.preventDefault()}),c.on("dragover",function(a){a=a.originalEvent||a,a.preventDefault()}),c.on("dragleave",function(a){a=a.originalEvent||a,a.preventDefault()}),c.on("drop",function(c){c=c.originalEvent||c,c.preventDefault();var f,g=c.dataTransfer.getData("Text")||c.dataTransfer.getData("text/plain");try{f=JSON.parse(g)}catch(h){return console.error("no dataTransfer, or could not parse dataTransfer"),!0}var i=b.$eval(e.dndDropList),j=b.$eval(e.dndCurrentDate);console.info(j),d.dropLogOnList({log:f,list:i,sso:a.user.sso,currentDate:j})})}}]),angular.module("clientApp").directive("fullHeight",["$window","$document",function(a,b){return{restrict:"A",link:function(b,c,d){function e(){var b=a.innerHeight;c.css("height",b-130+"px")}angular.element(a).on("resize",e),e()}}}]),angular.module("clientApp").service("authenticate",["$q","$rootScope","$cookieStore","$location","$http","socket",function(a,b,c,d,e,f){function g(b){var c=a.defer(),d=e.post("/login/createJSONWebToken",b);return d.success(function(a){c.resolve(a)}),d.error(function(a){c.reject(a)}),c.promise}function h(a,b){return"undefined"!=typeof a.permissions&&(-1!==a.permissions.indexOf("sudo")||-1!==a.permissions.indexOf(b))}function i(){var a=c.get("jwt");b.$emit("loggedOut",!0),a&&(console.info("User is logged in... logging them out...",a),c.remove("jwt"),f.emit("setUserOffline",a.sso))}function j(){var b=a.defer(),d=c.get("jwt");return d||b.reject({status:!1,data:"JWT not set"}),k(d).then(function(a){return a?l(d):void b.reject("No valid token.")}).then(function(a){b.resolve(a)})["catch"](function(a){b.reject(a)}),b.promise}function k(b){var c=a.defer(),d=e.post("/login/verifyJSONWebToken",b);return d.success(function(a){c.resolve(a.data)}),d.error(function(a){c.reject(a)}),c.promise}function l(b){var c=a.defer(),d=e.post("/login/getUserData",b);return d.success(function(a){a.status||c.reject(a.data),c.resolve(a.data)}),d.error(function(a){c.reject(a)}),c.promise}function m(b){var c=a.defer();b.preferences={sound:!1};var d=e.post("/signup",b);return d.success(function(a){a.status?g({sso:b.sso,pw:b.pw1}).then(function(a){c.resolve(a)})["catch"](function(a){c.reject(a)}):c.reject(a.data)}),d.error(function(a){console.error(a),c.reject("There was an internal error on the server. Please contact support!")}),c.promise}this.hasPermission=function(a,b){return h(a,b)},this.logOut=function(){return i()},this.createJSONWebToken=function(a){return g(a)},this.requireLogin=function(){return j()},this.signUp=function(a){return m(a)}}]),angular.module("clientApp").factory("socket",["$rootScope",function(a){var b=io.connect(),c=function(a,c){b.on(a,c)},d=function(a,c){b.emit(a,c)},e=function(a){d("lockLogEntry",a)},f=function(a){d("unlockLogEntry",a)},g=function(a){d("lockListEntry",a)},h=function(a){d("unlockListEntry",a)};return{on:c,emit:d,lockLogEntry:e,unlockLogEntry:f,lockListEntry:g,unlockListEntry:h}}]),angular.module("clientApp").factory("notifications",["$rootScope","$q","$http","webNotification","socket","sounds","growl",function(a,b,c,d,e,f,g){function h(a){switch(a.type){case"warning":g.warning(a.text,a.config),f.playSound("warning");break;case"error":g.error(a.text,a.config),f.playSound("error");break;case"success":g.success(a.text,a.config),f.playSound("success");break;case"info":g.info(a.text,a.config),f.playSound("info");break;default:g.info(a.text,a.config)}}function i(a){h(a)}function j(a){console.info("send global notification",a);var d=b.defer(),e=c.post("/notifications/global",a);return e.success(function(a){d.resolve(a)}),e.error(function(a){console.error(a),d.reject(a)}),d.promise}return{createPopup:function(a){return h(a)},createNotification:function(a){return i(a)},sendGlobalNotification:function(a){return j(a)}}}]),angular.module("clientApp").factory("sounds",["$rootScope",function(a){var b={success:"../../sounds/filling-your-inbox.mp3",info:"../../sounds/you-wouldnt-believe.mp3",warning:"../../sounds/demonstrative.mp3",error:"../../sounds/capisci.mp3",urgent:"../../sounds/solemn",click:"../../sounds/all-eyes-on-me.mp4",disabled:"../../sounds/your-turn.mp4"};return{playSound:function(c){var d=new Audio(b[c]);a.hasOwnProperty("user")&&a.user.preferences.sound&&d.play()}}}]),angular.module("clientApp").service("deskLogs",["$q","$http",function(a,b){function c(c,d){var e=a.defer();d&&angular.forEach(d,function(a,b){c+="/"+a});var f=b.get(c);return f.success(function(a){e.resolve(a)}),f.error(function(a){console.error(a),e.reject(a)}),e.promise}function d(c,d){var e=a.defer(),f=b.post(c,d);return f.success(function(a){e.resolve(a)}),f.error(function(a){console.error("ERROR:",a),e.reject(a)}),e.promise}function e(c,d){angular.forEach(d,function(a,b){c+="/"+a});var e=a.defer(),f=b["delete"](c,d);return f.success(function(a){e.resolve(a)}),f.error(function(a){console.error("ERROR:",a),e.reject(a)}),e.promise}function f(a,b){var c=[];return angular.forEach(a,function(a,d){this[d]=0,angular.forEach(a,function(a){angular.forEach(a.logs,function(a){null!==b&&"object"==typeof b&&b.hasOwnProperty(a)&&c[d]++})},c)},c),c}function g(a,b){var c={};return angular.forEach(a,function(a){c[a[b]]=a}),c}function h(a,b){for(var c={},d=0;d<a.length;d++)c.hasOwnProperty(a[d][b])||(c[a[d][b]]={}),c[a[d][b]][d]=a[d];return c}function i(b){var d=a.defer(),e={};return c("/deskLogs/desks",null).then(function(a){if(!a.status)throw new Error("Application bootstrap failed. Could not load desks.");return e.desks=a.data,c("/deskLogs/logs",{date:b})}).then(function(a){return e.logs=g(a.data,"_id"),c("deskLogs/lists",{date:b})}).then(function(a){return e.lists=h(a.data,"desk"),e.count=f(e.lists,e.logs),c("users",{})}).then(function(a){e.users=a.data,d.resolve(e)})["catch"](function(a){d.reject(a)}),d.promise}function j(a,b){var c=null;return angular.forEach(a[b.desk],function(a,d){a._id==b._id&&(c=d)}),c}function k(a){var b;return angular.forEach(a,function(a,c){a.defaultList&&(b=a)},b),b}this.updateLocalApplicationData=function(a){return i(a)},this.getDesks=function(){return c("/deskLogs/desks",null)},this.get=function(a,b){return c(a,b)},this.del=function(a,b){return e(a,b)},this.createList=function(a){return d("/deskLogs/lists",a)},this.updateList=function(a){return d("/deskLogs/lists/update",a)},this.deleteList=function(a){return e("/deskLogs/lists",a)},this.getListIndexFromSingleList=function(a,b){return j(a,b)},this.getDefaultList=function(a){return k(a)},this.organizeLists=function(a){return h(a,"desk")},this.getLists=function(a){return c("/deskLogs/lists",a)},this.getPermanentLists=function(){return c("deskLogs/lists/permanent")},this.getLogs=function(){return c("/deskLogs/logs",null)},this.getOrphanedLogs=function(){return c("/deskLogs/orphans")},this.getRepeatingStories=function(){return c("/deskLogs/logs/repeating/all")},this.getLogCount=function(a,b){return f(a,b)},this.createLog=function(a){return d("/deskLogs/logs",a)},this.createRepeatingLog=function(a){return d("deskLogs/logs/repeating",a)},this.updateRepeatingLog=function(a){return d("deskLogs/logs/repeating/update",a)},this.updateLog=function(a){return d("/deskLogs/logs/update",a)},this.deleteLog=function(a){return e("/deskLogs/logs",a)},this.trashLog=function(a){return e("deskLogs/logs/trash",a)},this.trashRepeatingLog=function(a){return e("deskLogs/logs/repeating",a)},this.restoreLog=function(a){return d("deskLogs/logs/restore",a)},this.updateLogOrder=function(a){return d("/deskLogs/lists/updateOrder",a)},this.organizeLogs=function(a){return g(a,"_id")},this.dropLogOnDesk=function(a){return d("/deskLogs/desks/moveLogToDesk",a);
},this.dropLogOnList=function(a){return a.currentDate=a.currentDate||new Date,d("/deskLogs/lists/moveLogToList",a)}}]),angular.module("clientApp").service("admin",function(){this.test=function(){}}),angular.module("clientApp").service("history",["$q","api","notifications",function(a,b,c){function d(d){var e=a.defer();return console.log(d),b.get("/history",d?[d]:null).then(function(a){e.resolve(a)})["catch"](function(a){console.error(a),c.createErrorPopup({text:a,title:"History Error!"})}),e.promise}this.getHistory=function(a){return d(a)}}]),angular.module("clientApp").factory("api",["$q","$http",function(a,b){function c(c,d){console.info("api.get()",c,d);var e=a.defer();d&&angular.forEach(d,function(a,b){c+="/"+a}),console.info(c);var f=b.get(c);return f.success(function(a){e.resolve(a)}),f.error(function(a){e.reject(a)}),e.promise}function d(c,d){var e=a.defer(),f=b.post(c,d);return f.success(function(a){e.resolve(a)}),f.error(function(a){console.error("ERROR:",a),e.reject(a)}),e.promise}function e(c,d){angular.forEach(d,function(a,b){c+="/"+a});var e=a.defer(),f=b["delete"](c,d);return f.success(function(a){e.resolve(a)}),f.error(function(a){console.error("ERROR:",a),e.reject(a)}),e.promise}return{get:function(a,b){return c(a,b)},post:function(a,b){return d(a,b)},del:function(a,b){return e(a,b)}}}]),angular.module("clientApp").service("monitor",["$q","$http",function(a,b){function c(){var c=a.defer(),d=b.get("/monitor");return d.success(function(a){c.resolve(a)}),d.error(function(a){console.error(a),c.reject(a)}),c.promise}this.getCurrentStatus=function(){return c()}}]),angular.module("clientApp").filter("capitalize",function(){return function(a,b){var c=b?/([^\W_]+[^\s-]*) */g:/([^\W_]+[^\s-]*)/;return a?a.replace(c,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()}):""}}),angular.module("clientApp").filter("removeHTML",function(){return function(a){return a?String(a).replace(/<[^>]+>/gm,""):""}}),angular.module("clientApp").filter("initialsFromSSO",function(){return function(a,b){if(a){var c="";return angular.forEach(b,function(b,d){b.sso==a&&(c=b.first.charAt(0)+b.last.charAt(0))}),c}}}),angular.module("clientApp").filter("nameFromSSO",function(){return function(a,b){if(a){var c="N/A";return angular.forEach(b,function(b){b.sso==a&&(c=b.first+" "+b.last)}),c}}}),angular.module("clientApp").filter("displayDays",function(){return function(a){var b="";return angular.forEach(a,function(a,c){a&&(b+=c+",")}),b.replace(/,\s*$/,"")}}),angular.module("clientApp").filter("getListTitleFromId",function(){return function(a,b){var c="N/A";return a&&angular.forEach(b,function(b){angular.forEach(b,function(b){a==b._id&&(c=b.title)})}),c}}),angular.module("clientApp").run(["$templateCache",function(a){a.put("views/admin.html",'<div class="row admin-panel"> <div class="col-sm-12"> <nav class="admin-sidebar" ng-class="{ closed: menuClosed }"> <ul> <li class="admin-sidebar-heading"> <span>Admin Panel</span> <i ng-click="toggleMenu()" class="fa fa-bars" aria-hidden="true"></i> </li> <li> <a ng-class="{active: currentPage == \'dashboard\'}" ng-click="changePage(\'dashboard\', $event)" href="#"><i class="fa fa-tachometer" aria-hidden="true"></i> Dashboard</a> <i class="hiddenMenu fa fa-tachometer" aria-hidden="true" ng-class="{active: currentPage == \'dashboard\'}" ng-click="changePage(\'dashboard\', $event)"></i> </li> <li><a ng-class="{active: currentPage == \'users\'}" ng-click="changePage(\'users\', $event)" href="#"><i class="fa fa-users" aria-hidden="true"></i> Users</a> <i class="hiddenMenu fa fa-users" aria-hidden="true" ng-class="{active: currentPage == \'users\'}" ng-click="changePage(\'users\', $event)"></i> </li> <li><a ng-class="{active: currentPage == \'lists\'}" ng-click="changePage(\'lists\', $event)" href="#"><i class="fa fa-tasks" aria-hidden="true"></i> Lists </a> <i class="hiddenMenu fa fa-tasks" aria-hidden="true" ng-class="{active: currentPage == \'lists\'}" ng-click="changePage(\'lists\', $event)"></i> </li> <li><a ng-class="{active: currentPage == \'stories\'}" ng-click="changePage(\'stories\', $event)" href="#"><i class="fa fa-file-text" aria-hidden="true"></i> Stories</a> <i class="hiddenMenu fa fa-file-text" aria-hidden="true" ng-class="{active: currentPage == \'stories\'}" ng-click="changePage(\'stories\', $event)"></i> </li> <li><a ng-class="{active: currentPage == \'reports\'}" ng-click="changePage(\'reports\', $event)" href="#"><i class="fa fa-line-chart" aria-hidden="true"></i> Reports</a> <i class="hiddenMenu fa fa-line-chart" aria-hidden="true" ng-class="{active: currentPage == \'reports\'}" ng-click="changePage(\'reports\', $event)"></i> </li> <li> <a ng-class="{active: currentPage == \'notifications\'}" ng-click="changePage(\'notifications\', $event)" href="#"><i class="fa fa-comment-o" aria-hidden="true"></i> Notifications</a> <i class="hiddenMenu fa fa-comment-o" aria-hidden="true" ng-class="{active: currentPage == \'notifications\'}" ng-click="changePage(\'notifications\', $event)"></i> </li> <li><a ng-class="{active: currentPage == \'status\'}" ng-click="changePage(\'status\', $event)" href="#"><i class="fa fa-heart" aria-hidden="true"></i> Server Status</a> <i class="hiddenMenu fa fa-heart" aria-hidden="true" ng-class="{active: currentPage == \'status\'}" ng-click="changePage(\'status\', $event)"></i> </li> </ul> </nav> <div class="admin-content-wrapper" ng-class="{closed: menuClosed }"> <div ng-controller="AdmindashboardCtrl" ng-if="currentPage == \'dashboard\'" ng-include="\'views/admin/dashboard.html\'"> </div> <div ng-controller="" ng-if="currentPage == \'users\'" ng-include="\'views/admin/users.html\'"> </div> <div ng-controller="AdminlistsCtrl" ng-if="currentPage == \'lists\'" ng-include="\'views/admin/lists.html\'"> </div> <div ng-controller="AdminstoriesCtrl" ng-if="currentPage == \'stories\'" ng-include="\'views/admin/stories.html\'"> </div> <div ng-controller="AdminreportsCtrl" ng-if="currentPage == \'reports\'" ng-include="\'views/admin/reports.html\'"> </div> <div ng-controller="AdminnotificationsCtrl" ng-if="currentPage == \'notifications\'" ng-include="\'views/admin/notifications.html\'"> </div> <div ng-controller="AdminmonitorCtrl" ng-if="currentPage == \'status\'" ng-include="\'views/admin/status.html\'"> </div> </div> </div> </div>'),a.put("views/admin/dashboard.html",'<div class="row"> <div class="col-lg-4">Test</div> <div class="col-lg-4">Test</div> <div class="col-lg-4">Test</div> </div>'),a.put("views/admin/lists.html",'<div class="row"> <div class="col-lg-12"> <uib-tabset type="pills"> <uib-tab ng-repeat="desk in desks" heading="{{desk.title | capitalize}}"> </uib-tab> </uib-tabset> </div> </div>'),a.put("views/admin/notifications.html",'<div class="row"> <div class="col-lg-12"> <uib-tabset type="pills"> <uib-tab heading="Notification Groups"> </uib-tab> <uib-tab heading="Send a Notification"> <div class="row"> <div class="col-lg-4"> <h2>Notification</h2> <form> <div class="row"> <div class="col-lg-6"> <fieldset class="form-group"> <label>Notification Type</label> <select ng-model="notification.type" class="form-control"> <option selected value="info">Info</option> <option value="success">Success</option> <option value="warning">Warning</option> <option value="error">Error</option> </select> </fieldset> </div> <div class="col-lg-6"> <fieldset class="form-group"> <label>TTL</label> <select ng-model="notification.config.ttl" class="form-control"> <option value="-1">Until Closed</option> <option value="1000">1 Second</option> <option value="3000">3 Seconds</option> <option value="3000">5 Seconds</option> <option value="3000">10 Seconds</option> </select> </fieldset> </div> </div> <div class="row"> <div class="col-lg-12"> <fieldset class="form-group"> <label>Title</label> <input class="form-control" ng-model="notification.config.title" type="text"> </fieldset> </div> </div> <div class="row"> <div class="col-lg-12"> <fieldset class="form-group"> <label>Text</label> <textarea class="form-control" ng-model="notification.text"></textarea> </fieldset> </div> </div> <div class="row"> <div class="col-lg-12"> <input ng-click="submit()" type="submit" class="form-control btn-success" value="Send"> </div> </div> </form> </div> <div class="col-lg-4"> <div class="row"> <h2>Select Recipients</h2> </div> </div> <div class="col-lg-4"> <div class="row"> <h2>Current Recipients</h2> </div> </div> </div> </uib-tab> </uib-tabset> </div> </div>'),a.put("views/admin/reports.html",'<div class="panel"> <div class="panel-heading"><h1>Heading</h1></div> <div class="panel-body"><h2>Reports</h2></div> <div class="panel-footer"><h3>Footer</h3></div> </div>'),a.put("views/admin/status.html",'<div class="row"> <div class="col-sm-12"> <div class="panel"> <div class="panel-heading"><h1>NBC News Channel DeskLogs Health Monitor</h1></div> <div class="panel-body"> <div class="row"> <div class="col-sm-12"> <div class="alert alert-info"> <p><i class="fa fa-info-circle" aria-hidden="true"></i>In addition to the metrics provided below, additional information can be found by accessing the <a title="Netdata Console" target="_blank" href="http://desklogs.nbcnewschannel.tv:19999">Netdata</a> console.</p> </div> </div> </div> <uib-tabset type="pills"> <uib-tab heading="Server"> <div class="row"> <h3>System Status</h3> <!-- System Info --> <div class="col-lg-2"> <h4>System Info</h4> <table class="table table-bordered"> <thead> <th>Hostname</th> <th>Uptime</th> </thead> <tbody> <td>{{status.system_info.hostname}}</td> <td>{{status.system_info.uptime}}</td> </tbody> </table> </div> <!-- Load Average --> <div class="col-lg-3"> <h4>Load Average</h4> <table class="table table-bordered"> <thead> <th>1 min</th> <th>5 min</th> <th>15 min</th> </thead> <tbody> <td>{{status.monit.loadavg[0]}}</td> <td>{{status.monit.loadavg[1]}}</td> <td>{{status.monit.loadavg[2]}}</td> </tbody> </table> </div> <!-- Memory Usage --> <div class="col-sm-2"> <h4>Memory</h4> <table class="table table-bordered"> <thead> <th>Total Memory</th> <th>Free Memory</th> </thead> <tbody> <td>{{status.monit.total_mem}}</td> <td>{{status.monit.free_mem}}</td> </tbody> </table> </div> </div> <hr> <div class="row"> <h3>Processor Utilization</h3> <div class="col-sm-4" ng-repeat="cpu in status.monit.cpu"> <p>{{cpu.model}}</p> <table class="table table-bordered"> <thead> <th>Speed</th> <th>User</th> <th>Nice</th> <th>System</th> <th>Idle</th> <th>IRQ</th> </thead> <tbody> <td>{{cpu.speed}}</td> <td>{{cpu.times.user}}</td> <td>{{cpu.times.nice}}</td> <td>{{cpu.times.sys}}</td> <td>{{cpu.times.idle}}</td> <td>{{cpu.times.irq}}</td> </tbody> </table> </div> </div> <hr> </uib-tab> <uib-tab heading="Application"> <div class="row"> <h3>Processes</h3> <div class="col-lg-12" ng-repeat="process in status.processes"> <table class="table table-bordered"> <thead> <th>Name</th> <th>PID</th> <th>CPU</th> <th>Memory</th> <th>NODE_ENV</th> <th>Uptime</th> <th>Restarts</th> </thead> <tbody> <td>{{process.name}}</td> <td>{{process.pid}}</td> <td>{{process.monit.cpu}}</td> <td>{{process.monit.memory}}</td> <td>{{process.pm2_env.NODE_ENV}}</td> <td>{{process.pm2_env.pm_uptime}}</td> <td>{{process.pm2_env.unstable_restarts}}</td> </tbody> </table> </div> </div> </uib-tab> </uib-tabset> </div> <div class="panel-footer"></div> </div> </div> </div>'),a.put("views/admin/stories.html",'<div class="row"> <div class="col-sm-12"> <uib-tabset type="pills"> <!-- Recycle Bin --> <uib-tab heading="Recycle Bin" ng-click="getOrphanedStories()"> <!-- Toolbar --> <div class="row"> <div class="col-sm-10"> <ul class="toolbox"> <li ng-click="deleteAllStories()"> <i class="fa fa-trash" aria-hidden="true"></i> Delete All </li> <li ng-click="getOrphanedStories()"> <i class="fa fa-refresh" ng-class="{\'fa-spin\' : loading}" aria-hidden="true"></i> Refresh </li> </ul> </div> <div class="col-sm-2"> <label class="disabled">Search for Deleted Item</label> <div class="input-group disabled"> <input type="text" class="form-control"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click=""> <i class="fa fa-search" aria-hidden="true"></i> </button> </span> </div> </div> </div> <!-- / Toolbar --> <!-- Table --> <div class="row" style="margin-top:10px"> <div ng-if="!stories" class="searchMessage"><h3 class="message">No stories were found.</h3></div> <div class="col-sm-12"> <table class="searchResults table table-bordered"> <thead> <tr> <th>Item</th> <th>Slug</th> <th>Source</th> <th>Method</th> <th>Created</th> <th>Details</th> </tr> </thead> <tbody> <tr ng-repeat="(key,story) in stories"> <td>{{story.itemno}}</td> <td>{{story.slug}}</td> <td>{{story.source}}</td> <td>{{story.contributionMethod}}</td> <td>{{story.createdAt | date : "h:mm a on MMMM d, yyyy"}} by {{story.createdBy | nameFromSSO: users}}</td> <td class="details"> <i class="fa fa-trash" ng-click="deleteStory(key,story._id)" aria-hidden="true"></i> <i class="fa fa-file" ng-click="restoreStory(key,story._id)" aria-hidden="true"></i> </td> </tr> </tbody> </table> </div> </div> <!-- / Table --> </uib-tab> <!-- / Recycle Bin --> <!-- Repeating Stories --> <uib-tab heading="Repeating Stories" ng-click="getRepeatingStories()"> <!-- Toolbar --> <div class="row"> <div class="col-sm-10"> <ul class="toolbox"> <li ng-click="createRepeatingStory()"> <i class="fa fa-plus" aria-hidden="true"></i> New Repeating Story </li> <li ng-click="getRepeatingStories()"> <i class="fa fa-refresh" ng-class="{\'fa-spin\' : loading}" aria-hidden="true"></i> Refresh </li> </ul> </div> <div class="col-sm-2"> <label class="disabled">Search Repeating Stories</label> <div class="input-group disabled"> <input type="text" class="form-control"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click=""> <i class="fa fa-search" aria-hidden="true"></i> </button> </span> </div> </div> </div> <!-- / Toolbar --> <div class="row" style="margin-top:10px"> <div ng-if="!stories" class="searchMessage"><h3 class="message">No stories were found.</h3></div> <div class="col-sm-12"> <table class="searchResults table table-bordered"> <thead> <tr> <th>Item</th> <th>Slug</th> <th>Desk</th> <th>List</th> <th>Days</th> <th>Created</th> <th>Actions</th> </tr> </thead> <tbody> <tr ng-repeat="(key,story) in stories"> <td>{{story.itemno}}</td> <td>{{story.slug}}</td> <td>{{story.desk | capitalize}}</td> <td>{{story.list | getListTitleFromId: lists | capitalize}}</td> <td>{{story.days | displayDays}}</td> <td>{{story.createdAt | date : "h:mm a on MMMM d, yyyy"}} by {{story.createdBy | nameFromSSO: users}}</td> <td class="details"> <i class="fa fa-trash" ng-click="deleteRepeatingStory(key,story._id)" aria-hidden="true"></i> <i class="fa fa-pencil" ng-click="editRepeatingStory(key,story)" aria-hidden="true"></i> </td> </tr> </tbody> </table> </div> </div> </uib-tab> <!-- / Repeating Stories --> <!-- All Stories --> <uib-tab heading="All Stories"> <h1>All Stories</h1> </uib-tab> <!-- / All Stories --> </uib-tabset> </div> </div> <!--\n\n\n-->'),a.put("views/admin/users.html",'<div class="panel"> <div class="panel-heading"><h1>Heading</h1></div> <div class="panel-body"><h2>Users</h2></div> <div class="panel-footer"><h3>Footer</h3></div> </div>'),a.put("views/help.html",'<div class="row"> <div class="panel"> <div class="panel-heading"> <h1>Help</h1> </div> <div class="panel-body"> <div class="col-sm-2"> <h3>Subjects</h3> <ul class=""> <li>Signing Up</li> <li>Logging In</li> <li> General Workflow and Application Structure <ul> <li>Desks</li> <li>Lists</li> <li>Stories</li> </ul> </li> <li>Changing the Current Working Date</li> <li> Changing Account Settings <ul> <li>Personal Information</li> <li>Desk Assignment</li> <li>Notification Settings</li> </ul> </li> </ul> </div> <div class="col-sm-10"> <section> <h3>Signing Up</h3> </section> <section> <h3>Logging In</h3> </section> <section> <h3>General Workflow and Application Structure</h3> </section> <section> <h3>Changing the Current Working Date</h3> </section> <section> <h3>Changing Account Settings</h3> </section> </div> </div> <div class="panel-footer">This is the footer.</div> </div> </div>'),a.put("views/login.html",'<div class="row"> <div class="col-lg-5 col-md-3 col-sm-1"></div> <div class="col-lg-2 col-md-6 col-sm-10"> <div class="panel login-panel"> <div class="panel-heading"> <img src="/images/DeskLogs-Login.fb6db940.png"> </div> <!-- / .panel-heading --> <div class="panel-body"> <form class="form-group"> <fieldset class="form-group"> <legend>DeskLogs Application Login</legend> <div class="form-group"> <label class="control-label" for="sso">SSO</label> <input ng-model="login.sso" id="sso" class="form-control input-md" type="text" name="sso" placeholder="ex. 123456789"> </div> <!-- Password --> <div class="form-group"> <label class="control-label" for="pw">Password</label> <input ng-model="login.pw" id="pw" class="form-control input-md" type="password" name="password"> </div> <div class="row"> <!--<div class="col-sm-7">\n                            <p class="error" ng-bind="login.error"></p>\n                        </div>--> <div class="col-sm-12"> <button ng-click="submit()" id="login_button" name="login" class="btn btn-success btn-block">Login </button> </div> </div> <!-- / .row --> </fieldset> <!-- SSO --> </form> <!-- / form.form-group --> </div> <!-- / .panel-body --> <div class="panel-footer"> <div class="row"> <div class="col-sm-12"> <!--<a href="/#/forgot" title="Reset your password">Forgot My Password</a> --> <a href="/#/signup" title="Register for DeskLogs">Sign Up for an Account</a> </div> </div> </div><!-- / .panel-footer --> </div> <!-- / .panel ng-controller --> </div> <!-- / .col-sm-2 --> <div class="col-lg-5 col-md-3 col-sm-1"></div> </div>'),a.put("views/main.html",'<div class="row"> <!-- .col-sm-9: Primary panel. --> <div class="col-sm-9"> <ul class="nav nav-tabs log-nav" id="desklogs-nav"> <li ng-repeat="desk in desks" ng-class="{\'active\':currentDesk == desk.title}" dnd-drop-desk="desk"> <a ng-click="selectTab(desk.title, $event);" data-tab="desk.title" href="{{desk.title}}">{{desk.title | capitalize}} <span class="badge purple" ng-if="count[desk.title] > 0">{{count[desk.title]}}</span> </a> </li> </ul> <div class="panel" id="primaryLogPanel"> <div class="panel-body logs" full-height> <!-- Toolbox Row --> <div class="row toolbox-container"> <div class="col-sm-10"> <ul class="toolbox"> <li ng-click="createLogEntry()"><i class="fa fa-plus" aria-hidden="true"></i>Add Story </li>  <li ng-class="{\'disabled\': !selectedLog._id}" ng-click="editLogEntry()"> <i class="fa fa-pencil" aria-hidden="true"></i>Edit Story </li> <li ng-class="{\'disabled\': !selectedLog._id}" ng-click="deleteLogEntry()"> <i class="fa fa-trash-o" aria-hidden="true"></i>Delete Story </li> </ul> </div> <div class="col-sm-2"> <div class="input-group datepicker"> <input type="text" class="form-control" uib-datepicker-popup="{{datepicker.format}}" ng-model="currentDate" ng-change="updateLocalApplicationData()" is-open="datepicker.opened" datepicker-options="datepicker.options" ng-required="true" close-text="Close" alt-input-formats="datepicker.altInputFormats"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="datepicker.open()"> <i class="fa fa-calendar" aria-hidden="true"></i> </button> </span> </div> </div> </div> <!-- / Toolbox Row --> <!-- List Header --> <table class="list-header"> <thead> <tr class="list-description"> <td class="itemno">Item #</td> <td class="slug">Slug</td> <td class="contributionMethod">Method</td> <td class="timeIn">In</td> <td class="timeOut">Out</td> <td class="txponder">Transponder</td> <td class="source">Source</td> <td class="feed">Feed</td> <td class="format">Format</td> <td class="wr">WR</td> <td class="updated">Modified</td> <td class="details">&nbsp;</td> </tr> </thead> </table> <!-- / List Header --> <div class="sticky"> <table class="list" ng-repeat="list in lists[currentDesk]"> <thead> <tr class="list-heading" dnd-drop-list="list" dnd-current-date="currentDate"> <th colspan="12"> <span class="heading"> <span class="list-icons"> <i ng-if="list.defaultList" title="Default List" class="fa fa-flag" aria-hidden="true"></i> <i ng-if="list.permanent && !list.defaultList" title="Permanent List" class="fa fa-calendar-o" aria-hidden="true"></i> </span> <span class="list-title">{{list.title | capitalize}}</span> <span class="list-controls"> <i ng-if="list.locked === true" class="fa fa-spinner fa-spin fa-fw"></i> </span> </span> </th> </tr> </thead> <tbody> <tr ng-repeat="logId in list.logs" ng-if="logs.hasOwnProperty(logId)" dnd-drag-log="logId" dnd-drag-current-list="list" dnd-drag-locked="logs[logId].locked" ng-class="{\'highlight\': selectedLog._id == logs[logId]._id }" ng-click="selectLog(logs[logId]._id, list._id)"> <td class="itemno">{{logs[logId].itemno}}</td> <td class="slug">{{logs[logId].slug}}</td> <td class="contributionMethod">{{logs[logId].contributionMethod | capitalize}}</td> <td class="timeIn">{{logs[logId].timeIn}}</td> <td class="timeOut">{{logs[logId].timeOut}}</td> <td class="txponder">{{logs[logId].txponder}}</td> <td class="source">{{logs[logId].source}}</td> <td class="feed">{{logs[logId].feed}}</td> <td class="format">{{logs[logId].format}}</td> <td class="wr">{{logs[logId].wr}}</td> <td class="updated">{{ logs[logId].updatedAt | date : "H:mm:ss"}}</td> <td class="details"> <i ng-if="logs[logId].ready == true" title="Ready for Feed" class="fa fa-sign-in"></i> <i ng-if="logs[logId].rnc" title="{{logs[logId].rnc | removeHTML}}" class="fa fa-exclamation-circle" aria-hidden="true"></i> <i ng-if="logs[logId].locked === true" class="fa fa-spinner fa-spin fa-fw"></i> </td> </tr> </tbody> </table> </div> </div> </div> </div> <!-- / .col-sm-9: Primary panel --> <!-- .col-sm-3: Details panel --> <div class="col-sm-3 details-column"> <div class="panel" id="detailsPanel" full-height> <div class="panel-heading has-toolbox"> <ul class="toolbox"> <li ng-class="{\'disabled\': !selectedLog._id}" ng-click="editLogEntry()"> <i class="fa fa-pencil" aria-hidden="true"></i>Edit Story </li> <li ng-class="{\'disabled\': !selectedLog._id}" ng-click="deleteLogEntry()"> <i class="fa fa-trash-o" aria-hidden="true"></i>Delete </li> </ul> </div> <div class="panel-body details"> <div class="row"> <div class="col-sm-12 title"> <h3>{{selectedLog.itemno}} {{selectedLog.slug}}</h3> </div> </div> <div class="row"> <div class="col-sm-6 details"> <p> <strong>Time In:</strong> {{selectedLog.timeIn}} </p> <p> <strong>Time Out:</strong> {{selectedLog.timeOut}} </p> <p> <strong>Feed:</strong> {{selectedLog.feed}} </p> <p> <strong>Source:</strong> {{selectedLog.source}} </p> </div> <div class="col-sm-6 details"> <p> <strong>Transponder:</strong> {{selectedLog.txponder}} </p> <p> <strong>Format:</strong> {{selectedLog.format}} </p> <p> <strong>Writer:</strong> {{selectedLog.wr}} </p> <p> <strong>Method:</strong> {{selectedLog.contributionMethod | capitalize}} </p> </div> </div> <div class="row"> <hr> <div class="col-sm-12 notes"> <h4>Rights &amp; Clearances:</h4> <div ng-bind-html="trustHTML(selectedLog.rnc)"></div> </div> </div> <div class="row"> <hr> <div class="col-sm-12 notes"> <h4>Notes:</h4> <div ng-bind-html="trustHTML(selectedLog.notes)"></div> </div> </div> </div> <div class="panel-footer"> <div class="row"> <div class="col-sm-6 footer-details"> <p ng-if="selectedLog.createdBy"> Created by {{selectedLog.createdBy | nameFromSSO: users}} <br>at {{selectedLog.createdAt | date : "h:mm a on MMMM d, yyyy"}} </p> </div> <div class="col-sm-6 footer-details"> <p ng-if="selectedLog.createdBy"> Updated by {{selectedLog.updatedBy | nameFromSSO: users}} <br>on {{selectedLog.updatedAt | date : "h:mm a on MMMM d, yyyy"}} </p> </div> </div> </div> </div> </div> <!-- / .col-sm-3: Details column. --> </div>'),a.put("views/settings.html",'<div class="row"> <div class="col-sm-4"> <div class="panel"> <div class="panel-heading"><h3><i class="fa fa-user" aria-hidden="true"></i> My Account</h3><hr></div> <div class="panel-body"> <div class="row"> <div class="col-sm-12"> <uib-tabset type="pills"> <!-- uib-tab "Profile" --> <uib-tab heading="Profile"> <div class="row"> <div class="col-sm-12"> <!-- My Information --> <div class="row"> <div class="col-sm-6"> <h4>My Information</h4> <ul class="my-info"> <li><i class="fa fa-user" aria-hidden="true"></i> {{user.first}} {{user.last}} <span>({{user.sso}})</span></li> <li><i class="fa fa-envelope" aria-hidden="true"></i> {{user.email}}</li> <li><i class="fa fa-phone" aria-hidden="true"></i> {{user.phone}}</li> </ul> <p class="text-warning"> <i class="fa fa-exclamation-triangle" aria-hidden="true"></i> This information is set on the Manage Page and can not be changed here. </p> </div> <!-- Password --> <div class="col-sm-6"> <form> <fieldset> <legend>Change Password</legend> <div class="form-group" ng-class="{\'has-danger\' : status.error.pw1}"> <label for="pw1">New Password</label> <input class="form-control" ng-model="form.pw1" type="password" name="pw1" id="pw1"> </div> <div class="form-group" ng-class="{\'has-danger\' : status.error.pw2}"> <label for="pw2">Repeat New Password</label> <input class="form-control" ng-model="form.pw2" type="password" name="pw2" id="pw2"> </div> </fieldset> </form> </div> <!-- / Password --> </div> <!-- / My Information --> <!-- Desk and Password Change --> <div class="row"> <div class="col-sm-12"> <div class="form-group"> <button type="submit" class="btn btn-success form-control" ng-click="saveAccount()">Save Changes</button> </div> </div> </div> </div> </div> <!-- / row --> </uib-tab> <!-- / uib-tab "Profile" --> <!-- uib-tab "Notification Settings" TODO: Build out notification settings. --> <!--<uib-tab heading="Notification Settings">\n                                <div class="row">\n                                    <div class="col-sm-12">\n                                        <form>\n                                            <fieldset>\n                                                <legend>Notification Settings</legend>\n\n                                                <div class="checkbox">\n                                                    <label>\n                                                        <input ng-model="user.preferences.sound"\n                                                               ng-change="updatePreferences()"\n                                                               value="1"\n                                                               type="checkbox"> Play sounds.\n                                                    </label>\n                                                </div>\n\n                                                <div class="checkbox">\n                                                    <label>\n                                                        <input ng-model="user.preferences.notifyOnDesk"\n                                                               ng-change="updatePreferences()"\n                                                               value="1" type="checkbox"> Notify me when a new story is assigned to my desk.\n                                                    </label>\n                                                </div>\n\n                                                <div class="checkbox">\n                                                    <label>\n                                                        <input ng-model="user.preferences.notifyCreateOnEdit"\n                                                               ng-change="updatePreferences()"\n                                                               value="1" type="checkbox"> Notify me when a story I created has been edited.\n                                                    </label>\n                                                </div>\n\n                                                <div class="checkbox">\n                                                    <label>\n                                                        <input ng-model="user.preferences.notifyModifyOnEdit"\n                                                               ng-change="updatePreferences()"\n                                                               value="1" type="checkbox"> Notify me when a story I last modified has been edited.\n                                                    </label>\n                                                </div>\n\n                                            </fieldset>\n                                        </form>\n                                    </div>\n                                </div>\n                            </uib-tab> --> <!-- / uib-tab "Notification Settings" --> </uib-tabset> </div> </div> <!-- / row --> </div> <div class="panel-footer"> <p class="status-message" ng-class="{\'has-error\' : status.error.flag}" ng-bind-html="trustHTML(status.message)"></p> </div> </div> </div> <!-- Statistics panel --> <div class="col-sm-8"> <div class="panel"> <div class="panel-heading"> <h3><i class="fa fa-bar-chart" aria-hidden="true"></i> Statistics</h3><hr> <uib-tabset type="pills"> <uib-tab heading="Created Stories"> <h4>Created Stories</h4> </uib-tab> <uib-tab heading="History"> <h4>History</h4> </uib-tab> </uib-tabset> </div> <div class="panel-body"> </div> <div class="panel-footer"></div> </div> </div> <!-- / Statistics Panel --> </div> <!-- / .row -->'),a.put("views/signup.html",'<div class="row"> <div class="col-sm-5"></div> <div class="col-sm-2"> <div class="panel login-panel" ng-controller="SignupCtrl"> <div class="panel-heading"> <img src="/images/DeskLogs-Login.fb6db940.png"> </div> <!-- / .panel-heading --> <div class="panel-body"> <form class="form-group"> <fieldset> <legend>DeskLog Application Registration</legend> <!-- SSO --> <div class="form-group" ng-class="{\'has-danger\': signup.error.sso}"> <label class="control-label" for="sso">SSO</label> <input ng-model="signup.user.sso" id="sso" class="form-control input-md" type="text" name="sso" placeholder="ex. 123456789"> </div> <!-- Password --> <div class="form-group" ng-class="{\'has-danger\': signup.error.pw1}"> <label class="control-label" for="pw1">Password</label> <input ng-model="signup.user.pw1" id="pw1" class="form-control input-md" type="password" name="pw1"> </div> <!-- Repeat Password --> <div class="form-group" ng-class="{\'has-danger\': signup.error.pw1}"> <label class="control-label" for="pw2">Repeat Password</label> <input ng-model="signup.user.pw2" id="pw2" class="form-control input-md" type="password" name="pw2"> </div> <div class="row"> <div class="col-sm-12"> <button ng-click="signup.submit()" id="login_button" name="login" class="btn btn-success btn-block">Login </button> </div> </div> <!-- / .row --> </fieldset> </form> <!-- / form.form-group --> </div> <!-- / .panel-body --> <div class="panel-footer"> <div class="row"> <div class="col-sm-12"> <a href="/#/login" title="Back to login page.">Back to Login</a> </div> </div> </div><!-- / .panel-footer --> </div> <!-- / .panel ng-controller --> </div> <!-- / .col-sm-2 --> <div class="col-sm-5"></div> </div>'),a.put("views/templates/alert.html",'<script type="text/ng-template" id="alert.html"><div class="alert" style="background-color:#fa39c3;color:white" role="alert">\n        <div ng-transclude></div>\n    </div></script> <uib-alert ng-repeat="alert in alerts.popups" type="{{alert.type}}" close="alerts.closeNotification($index)" dismiss-on-timeout="3000"> <div class="col-sm-2 alert-icon"><i class="fa {{alert.icon}}" aria-hidden="true"></i></div> <div class="col-sm-10 alert-body"> <span class="title">{{alert.title}}</span> <span class="message">{{alert.msg}}</span> <span class="date">{{alert.date}}</span> </div> <div style="clear:both"></div> </uib-alert>'),a.put("views/templates/modalAccountSettings.html",'<div class="modal-content"> <div class="modal-header"> <button type="button" class="close" ng-click="close()">&times;</button> <h4>{{title}}</h4> </div> <form id="createSeparator"> <div class="modal-body"> <div class="row"> <div class="col-sm-12"> <fieldset class="form-group"> <label for="list-desk">Desk</label> <select ng-model="form.desk" class="form-control" name="desk" id="list-desk"> <option ng-repeat="desk in desks" value="{{desk.title}}">{{desk.title | capitalize}} </option> </select> </fieldset> </div> </div> <div class="row"> <div class="col-sm-12"> <fieldset class="form-group"> <label for="list-title">Title</label> <input ng-model="form.title" class="form-control" name="title" id="list-title"> </fieldset> </div> </div> <div class="row"> <div class="col-sm-12"> <label>Permanent List? </label> <input ng-model="form.permanent" type="checkbox" val="1" name="permanent"> </div> </div> <div class="row"> <div class="col-sm-6"> <button ng-click="close()" type="button" class="btn btn-default">Close</button> </div> <div class="col-sm-6"> <input ng-click="submit()" type="submit" class="form-control btn-success" value="Save"> </div> </div> </div> <div class="modal-footer"> <div class="row"> <div class="col-sm-10"><p class="error">{{error}}</p></div> <div class="col-sm-1"> <i style="position:relative" ng-if="!panelLocked" uib-tooltip="{{tooltips.lock}}" tooltip-placement="right" ng-click="togglePanelLock()" class="fa fa-unlock-alt" aria-hidden="true"></i> <i style="position:relative" ng-if="panelLocked" uib-tooltip="{{tooltips.lock}}" tooltip-placement="right" ng-click="togglePanelLock()" class="fa fa-lock" aria-hidden="true"></i> </div> </div> </div> </form> </div>'),
a.put("views/templates/modalFeedbackEntry.html",'<div class="modal-content"> <div class="modal-header"> <button type="button" class="close" ng-click="close()">&times;</button> <h4>Feedback</h4> <p>I have spent a lot of time making this application run as smoothly as possible, but there is always the possiblilty that I missed something. Use this form to let me know of any bugs you find, any features or functionality you would like to see added, or to simply let me know how you like the application. <br>Thanks!<br>Lee </p> </div> <form id="createSeparator"> <div class="modal-body"> <div class="row"> <div class="col-sm-6"> <fieldset class="form-group"> <label for="type">Feedback Type</label> <select class="form-control" ng-model="form.type" id="type"> <option value="bug">Bug / Issue</option> <option value="request">Feature Request</option> <option value="question">Question</option> <option value="general">General Feedback</option> </select> </fieldset> </div> <div class="col-sm-6"> <fieldset class="form-group"> <label for="subject">Subject</label> <input type="text" class="form-control" ng-model="form.subject" id="subject"> </fieldset> </div> </div> <div class="row"> <div class="col-sm-12"> <fieldset class="form-group"> <label for="text">Feedback</label> <wysiwyg textarea-id="text" textarea-name="text" textarea-menu="wysiwyg.buttons" textarea-class="form-control" textarea-height="90px" ng-model="form.text" textarea-required="false" enable-bootstrap-title="true"></wysiwyg> </fieldset> </div> </div> <div class="row"> <div class="col-sm-6"> <button ng-click="close()" type="button" class="btn btn-default">Close</button> </div> <div class="col-sm-6"> <input ng-click="submit()" type="submit" class="form-control btn-success" value="Send Feedback"> </div> </div> </div> </form> </div>'),a.put("views/templates/modalListEntry.html",'<div class="modal-content"> <div class="modal-header"> <button type="button" class="close" ng-click="close()">&times;</button> <h4>{{title}}</h4> </div> <form id="createSeparator"> <div class="modal-body"> <div class="row"> <div class="col-sm-12"> <fieldset class="form-group"> <label for="list-desk">Desk</label> <select ng-model="form.desk" class="form-control" name="desk" id="list-desk"> <option ng-repeat="desk in desks" value="{{desk.title}}">{{desk.title | capitalize}} </option> </select> </fieldset> </div> </div> <div class="row"> <div class="col-sm-12"> <fieldset class="form-group"> <label for="list-title">Title</label> <input ng-model="form.title" class="form-control" name="title" id="list-title"> </fieldset> </div> </div> <div class="row"> <div class="col-sm-12"> <label>Permanent List? </label> <input ng-model="form.permanent" type="checkbox" val="1" name="permanent"> </div> </div> <div class="row"> <div class="col-sm-6"> <button ng-click="close()" type="button" class="btn btn-default">Close</button> </div> <div class="col-sm-6"> <input ng-click="submit()" type="submit" class="form-control btn-success" value="Save"> </div> </div> </div> <div class="modal-footer"> <div class="row"> <div class="col-sm-10"><p class="error">{{error}}</p></div> <div class="col-sm-1"> <i style="position:relative" ng-if="!panelLocked" ng-click="togglePanelLock()" class="fa fa-unlock-alt" aria-hidden="true"></i> <i style="position:relative" ng-if="panelLocked" ng-click="togglePanelLock()" class="fa fa-lock" aria-hidden="true"></i> </div> </div> </div> </form> </div>'),a.put("views/templates/modalLogEntry.html",'<div class="modal-content"> <div class="modal-header"> <button type="button" class="close" ng-click="close()">&times;</button> <h4>{{title}}</h4> </div> <div class="modal-body"> <form id="saveLog" class="log-form"> <div class="col-sm-6"> <div class="row"> <div class="col-sm-4"> <fieldset class="form-group"> <label>List</label> <select ng-model="form.selectedList" ng-options="list._id as (list.title | capitalize) for list in lists[currentDesk]" class="form-control" name="format"> </select> </fieldset> </div> <div class="col-sm-4"> <fieldset class="form-group"> <label for="form_itemno">Item Number</label> <input ng-model="form.itemno" class="form-control" type="text" name="itemno" id="form_itemno"> </fieldset> </div> <div class="col-sm-4"> <fieldset class="form-group"> <label for="form_wr">Writer</label> <input class="form-control" type="text" name="wr" ng-model="form.wr" id="form_wr"> </fieldset> </div> </div> <div class="row"> <div class="col-sm-12"> <fieldset class="form-group"> <label for="form_slug">Slug</label> <input ng-model="form.slug" class="form-control" type="text" name="slug" id="form_slug"> </fieldset> </div> </div> <div class="row"> <div class="col-sm-8"> <fieldset class="form-group"> <label for="contribution-method">Contribution Method</label> <select class="form-control" ng-model="form.contributionMethod" id="contribution-method"> <option selected value="Unknown">Unknown</option> <option value="Apple TV">Apple TV</option> <option value="Archives">Archives</option> <option value="Bonded Cellular">Bonded Cellular (Dejero, LiveU...)</option> <option value="Dropbox">Dropbox</option> <option value="Email">Email</option> <option value="FTP">FTP</option> <option value="Internet">Internet</option> <option value="Latakoo">Latakoo</option> <option value="Satellite">Satellite</option> <option value="Send2NC">Send2NC</option> <option value="Send This File">Send This File</option> <option value="Stills">Stills</option> <option value="Transfer - DC">Transfer - DC</option> <option value="Transfer - NC">Transfer - NC</option> <option value="Videoship Stream">Videoship Stream</option> <option value="We Transfer">We Transfer</option> </select> </fieldset> </div> <div class="col-sm-4"> <fieldset class="form-group"> <label for="form_from">Source</label> <input ng-model="form.source" class="form-control" type="text" name="form_from" id="form_from"> </fieldset> </div> </div> <div class="row"> <div class="col-sm-4"> <fieldset class="form-group"> <label for="form_timeIn">Time In</label> <input ng-model="form.timeIn" class="form-control" type="text" name="timeIn" id="form_timeIn"> </fieldset> </div> <div class="col-sm-4"> <fieldset class="form-group"> <label for="form_timeOut">Time Out</label> <input ng-model="form.timeOut" class="form-control" type="text" name="timeOut" id="form_timeOut"> </fieldset> </div> <div class="col-sm-4"> <fieldset class="form-group"> <label for="form_feed">Feed</label> <input ng-model="form.feed" class="form-control" type="text" name="feed" id="form_feed"> </fieldset> </div> </div> <div class="row"> <div class="col-sm-8"> <fieldset class="form-group"> <label for="form_txponder"> Transponder</label> <input ng-model="form.txponder" class="form-control" type="text" name="tx" id="form_txponder"> </fieldset> </div> <div class="col-sm-4"> <fieldset class="form-group"> <label for="form_format">Format</label> <select ng-model="form.format" class="form-control" name="format" id="form_format"> <option value="N/A">N/A</option> <option value="Raw">Raw</option> <option value="VOSOT">VOSOT</option> <option value="SOT">SOT</option> <option value="file">File</option> <option value="VO/NAT">VO/NAT</option> <option value="VO/Silent">VO/Silent</option> <option value="PKG">PKG</option> <option value="Segment">Segment</option> </select> </fieldset> </div> </div> <div class="row"> <div class="col-sm-8"> <div class="input-group datepicker"> <label>Active Date</label> <input type="text" class="form-control" uib-datepicker-popup="{{datepicker.format}}" ng-model="form.activeDate" is-open="datepicker.opened" datepicker-options="datepicker.options" ng-required="true" close-text="Close" alt-input-formats="datepicker.altInputFormats"> <span class="input-group-btn" style="top:13px"> <button type="button" class="btn btn-default" ng-click="datepicker.open()"> <i class="fa fa-calendar" aria-hidden="true"></i> </button> </span> </div> </div> <div style="margin-top: 32px" class="col-sm-4"> <label>Ready? </label> <input ng-model="form.ready" type="checkbox"> </div> </div> </div> <div class="col-sm-6"> <div class="row"> <div class="row"> <div class="col-sm-12"> <fieldset class="form-group"> <label>Rights and Clearances</label> <wysiwyg textarea-id="form_rnc" textarea-name="rnc" textarea-menu="wysiwyg.buttons" textarea-class="form-control" textarea-height="79px" ng-model="form.rnc" textarea-required="false" enable-bootstrap-title="true"></wysiwyg> </fieldset> </div> </div> </div> <div class="row"> <div class="row"> <div class="col-sm-12"> <fieldset class="form-group"> <label>Notes</label> <wysiwyg textarea-id="form_notes" textarea-name="notes" textarea-menu="wysiwyg.buttons" textarea-class="form-control" textarea-height="224px" ng-model="form.notes" textarea-required="false" enable-bootstrap-title="true"></wysiwyg> </fieldset> </div> </div> </div> </div> </form> </div> <div style="clear:both" class="modal-footer"> <div class="row"> <div class="col-sm-8"> <input ng-click="submit()" type="submit" class="form-control btn-success" value="Save"> </div> <div class="col-sm-3"> <button style="float:left" type="button" class="btn btn-default" ng-click="close()">Close</button> </div> <div class="col-sm-1" style="margin-top:10px"> <i style="position:relative" ng-if="!panelLocked" ng-click="togglePanelLock()" class="fa fa-unlock-alt" aria-hidden="true"></i> <i style="position:relative" ng-if="panelLocked" ng-click="togglePanelLock()" class="fa fa-lock" aria-hidden="true"></i> </div> </div> </div> </div>'),a.put("views/templates/modalRepeatingLogEntry.html",'<div class="modal-content"> <div class="modal-header"> <button type="button" class="close" ng-click="close()">&times;</button> <h4>{{title}}</h4> </div> <div class="modal-body"> <form id="saveLog" class="log-form"> <div class="col-sm-6"> <div class="row"> <div class="col-sm-4"> <fieldset class="form-group"> <label>Desk</label> <select ng-model="form.desk" ng-options="desk as (desk | capitalize) for (desk,list) in lists" class="form-control" name="format"> </select> </fieldset> </div> <div class="col-sm-8"> <fieldset class="form-group"> <label>List</label> <select ng-model="form.list" ng-options="list._id as (list.title | capitalize) for list in lists[form.desk]" class="form-control" name="format"> </select> </fieldset> </div> </div> <div class="row"> <div class="col-sm-4"> <fieldset class="form-group"> <label>Item #</label> <input ng-model="form.itemno" class="form-control" type="text" name="itemno"> </fieldset> </div> <div class="col-sm-8"> <fieldset class="form-group"> <label for="form_slug">Slug</label> <input ng-model="form.slug" class="form-control" type="text" name="slug" id="form_slug"> </fieldset> </div> </div> <div class="row"> <div class="col-sm-8"> <fieldset class="form-group"> <label for="contribution-method">Contribution Method</label> <select class="form-control" ng-model="form.contributionMethod" id="contribution-method"> <option selected value="Unknown">Unknown</option> <option value="Apple TV">Apple TV</option> <option value="Archives">Archives</option> <option value="Bonded Cellular">Bonded Cellular (Dejero, LiveU...)</option> <option value="Dropbox">Dropbox</option> <option value="Email">Email</option> <option value="FTP">FTP</option> <option value="Internet">Internet</option> <option value="Latakoo">Latakoo</option> <option value="Satellite">Satellite</option> <option value="Send2NC">Send2NC</option> <option value="Send This File">Send This File</option> <option value="Stills">Stills</option> <option value="Transfer - DC">Transfer - DC</option> <option value="Transfer - NC">Transfer - NC</option> <option value="Videoship Stream">Videoship Stream</option> <option value="We Transfer">We Transfer</option> </select> </fieldset> </div> <div class="col-sm-4"> <fieldset class="form-group"> <label for="form_from">Source</label> <input ng-model="form.source" class="form-control" type="text" name="form_from" id="form_from"> </fieldset> </div> </div> <div class="row"> <div class="col-sm-4"> <fieldset class="form-group"> <label for="form_timeIn">Time In</label> <input ng-model="form.timeIn" class="form-control" type="text" name="timeIn" id="form_timeIn"> </fieldset> </div> <div class="col-sm-4"> <fieldset class="form-group"> <label for="form_timeOut">Time Out</label> <input ng-model="form.timeOut" class="form-control" type="text" name="timeOut" id="form_timeOut"> </fieldset> </div> <div class="col-sm-4"> <fieldset class="form-group"> <label for="form_feed">Feed</label> <input ng-model="form.feed" class="form-control" type="text" name="feed" id="form_feed"> </fieldset> </div> </div> <div class="row"> <div class="col-sm-8"> <fieldset class="form-group"> <label for="form_txponder"> Transponder</label> <input ng-model="form.txponder" class="form-control" type="text" name="tx" id="form_txponder"> </fieldset> </div> <div class="col-sm-4"> <fieldset class="form-group"> <label for="form_format">Format</label> <select ng-model="form.format" class="form-control" name="format" id="form_format"> <option value="N/A">N/A</option> <option value="Raw">Raw</option> <option value="VOSOT">VOSOT</option> <option value="SOT">SOT</option> <option value="file">File</option> <option value="VO/NAT">VO/NAT</option> <option value="VO/Silent">VO/Silent</option> <option value="PKG">PKG</option> <option value="Segment">Segment</option> </select> </fieldset> </div> </div> <div class="row"> <div class="col-sm-12"> <fieldset class="form-group"> <legend>Select Days to Repeat</legend> <p>This story will auto-populate at midnight on each day selected.</p> <div class="row"> <div class="col-sm-6"> <div class="checkbox"> <label> <input type="checkbox" ng-model="form.days.mon"> Monday </label> </div> <div class="checkbox"> <label> <input type="checkbox" ng-model="form.days.tues"> Tuesday </label> </div> <div class="checkbox"> <label> <input type="checkbox" ng-model="form.days.wed"> Wednesday </label> </div> <div class="checkbox"> <label> <input type="checkbox" ng-model="form.days.thurs"> Thursday </label> </div> </div> <div class="col-sm-6"> <div class="checkbox"> <label> <input type="checkbox" ng-model="form.days.fri"> Friday </label> </div> <div class="checkbox"> <label> <input type="checkbox" ng-model="form.days.sat"> Saturday </label> </div> <div class="checkbox"> <label> <input type="checkbox" ng-model="form.days.sun"> Sunday </label> </div> </div> </div> </fieldset> </div> </div> </div> <!-- / Left Column --> <!-- Right Column --> <div class="col-sm-6"> <div class="row"> <div class="row"> <div class="col-sm-12"> <fieldset class="form-group"> <label>Rights and Clearances</label> <wysiwyg textarea-id="form_rnc" textarea-name="rnc" textarea-menu="wysiwyg.buttons" textarea-class="form-control" textarea-height="79px" ng-model="form.rnc" textarea-required="false" enable-bootstrap-title="true"></wysiwyg> </fieldset> </div> </div> </div> <div class="row"> <div class="row"> <div class="col-sm-12"> <fieldset class="form-group"> <label>Notes</label> <wysiwyg textarea-id="form_notes" textarea-name="notes" textarea-menu="wysiwyg.buttons" textarea-class="form-control" textarea-height="362px" ng-model="form.notes" textarea-required="false" enable-bootstrap-title="true"></wysiwyg> </fieldset> </div> </div> </div> </div> </form> </div> <!-- / Right Column --> <!-- Footer --> <div style="clear:both" class="modal-footer"> <div class="row"> <div class="col-sm-11"> <input ng-click="submit()" type="submit" class="form-control btn-success" value="Save"> </div> <div class="col-sm-1" style="margin-top:10px"> <i style="position:relative" ng-if="!panelLocked" ng-click="togglePanelLock()" class="fa fa-unlock-alt" aria-hidden="true"></i> <i style="position:relative" ng-if="panelLocked" ng-click="togglePanelLock()" class="fa fa-lock" aria-hidden="true"></i> </div> </div> </div> </div>')}]);